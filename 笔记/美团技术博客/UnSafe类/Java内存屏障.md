# 内存屏障
- 在 Java 8 中引入，用于定义内存屏障（也称内存栅栏，内存栅障，屏障指令等，
是一类同步屏障指令，是 CPU 或编译器在对内存随机访问的操作中的一个同步点，
使得此点之前的所有读写操作都执行后才可以开始执行此点之后的操作），避免代码
重排序。

``` 
// 内存屏障，禁止 load 操作重排序。屏障前的 load 操作不能被重排序到屏障后，屏障后的
load 操作不能被重排序到屏障前
public native void loadFence();
// 内存屏障，禁止 store 操作重排序。屏障前的 store 操作不能被重排序到屏障后，屏障后
的 store 操作不能被重排序到屏障前
public native void storeFence();
// 内存屏障，禁止 load、store 操作重排序
public native void fullFence();
```

## 典型应用

- 在 Java 8 中引入了一种锁的新机制——StampedLock，它可以看成是读写锁的
  一个改进版本。StampedLock 提供了一种乐观读锁的实现，这种乐观读锁类似于无锁
  的操作，**完全不会阻塞写线程获取写锁**，从而缓解读多写少时写线程“饥饿”现象。
  由于 StampedLock 提供的乐观读锁不阻塞写线程获取读锁，当线程共享变量从主内
  存 load 到线程工作内存时，会存在数据不一致问题，所以当使用 StampedLock 的
  乐观读锁时，需要遵从如下图用例中使用的模式来确保数据的一致性。